{% extends 'base.html' %}
{% load static %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/question_create.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/group_post_create.css' %}">
{% endblock %}

{% block js %}
    <script type="text/javascript" src="/static/js/qna_create.js" defer></script>
{% endblock %} 

{% block content %}

<div class="post-create__container">
    <div class="post-create__top">
        <span>궁금한 내용을 물어보세요!</span>
    </div>
    <div class="post-create-form">
    <form action="" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="post-create__input post-create__input--title">
                {% if error_messages.title %}
                <span class="input-error">
                    <svg width="5" height="14" viewBox="0 0 9 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.3125 21.5825C8.3125 23.7364 6.56016 25.4888 4.40625 25.4888C2.25234 25.4888 0.5 23.7364 0.5 21.5825C0.5 19.4286 2.25234 17.6763 4.40625 17.6763C6.56016 17.6763 8.3125 19.4286 8.3125 21.5825ZM0.952148 1.71919L1.61621 15.0004C1.64741 15.6241 2.16216 16.1138 2.78662 16.1138H6.02588C6.65034 16.1138 7.16509 15.6241 7.19629 15.0004L7.86035 1.71919C7.8938 1.0498 7.36016 0.48877 6.68994 0.48877H2.12256C1.45234 0.48877 0.918701 1.0498 0.952148 1.71919Z" fill="#EB6464"></path>
                    </svg>
                    {{ error_messages.title }}
                </span>
                {% endif %}
                <input type="text" name="title" id="title"  class="input-title" placeholder="제목을 50자 이내로 입력하세요."
                value="{% if original_information %}{{ original_information.title }}{% else %}{{ question.title }}{% endif %}"/>
            </div>
            <div class="post-create__input post-create__input--content">
                <!-- 내용 에러 메시지 --> 
                {% if error_messages.content %}
                <span class="input-error">
                    <svg width="5" height="14" viewBox="0 0 9 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.3125 21.5825C8.3125 23.7364 6.56016 25.4888 4.40625 25.4888C2.25234 25.4888 0.5 23.7364 0.5 21.5825C0.5 19.4286 2.25234 17.6763 4.40625 17.6763C6.56016 17.6763 8.3125 19.4286 8.3125 21.5825ZM0.952148 1.71919L1.61621 15.0004C1.64741 15.6241 2.16216 16.1138 2.78662 16.1138H6.02588C6.65034 16.1138 7.16509 15.6241 7.19629 15.0004L7.86035 1.71919C7.8938 1.0498 7.36016 0.48877 6.68994 0.48877H2.12256C1.45234 0.48877 0.918701 1.0498 0.952148 1.71919Z" fill="#EB6464"></path>
                    </svg>
                    {{ error_messages.content }}
                </span>
                {% endif %}
                <textarea id="content" cols="30" rows="10" class="input-content" placeholder="내용을 입력하세요." name="content">{% if original_information %}{{ original_information.content }}{% else %}{{ question.content }}{% endif %}</textarea>
            </div>

            <div class="post-create__img post-create__form">
                <div class="text-container">
                    <span>사진</span>
                </div>
                <div class="group-post__form-box">  
                    <input  id="img_upload_name" class="group-post__form-input group-post__form-input--image" placeholder="첨부파일" readonly  />
                    <img id="img_display" src="" height="50" width="50">
                    <label for="img_upload" class="group-post__form-label">사진 올리기</label>
                    <input type="file" id="img_upload" class="form__input--file" name="image" onchange="imageChange(event);">
                    <input name="img_recent" id="img_recent" value="{% if current_image %}{{ current_image }}{% else %}{{ original_information.image }}{% endif %}" hidden />
                    <input id="temp_img_location" value="{{ temp_img_location }}" hidden></input>
                </div>
            </div>
            <div class="post-create__attached-file post-create__form">
                <div class="text-container">
                    <span>파일</span>
                </div>
                <div class="group-post__form-box">
                    <input id="file_upload_name" class="group-post__form-input group-post__form-input--file"  placeholder="첨부파일" readonly/>
                    <label for="file_upload" class="group-post__form-label">파일 올리기</label>
                    <input type="file" class="form__input--file" id="file_upload" name="attached_file" value="{{ form.attached_file.url }}" onchange="fileChange(event); "/>
                    <input name="file_recent" id="file_recent" value="{% if current_file %}{{ current_file }}{% else %}{{ original_information.attached_file }}{% endif %}" hidden />
                    <input id="temp_file_location" value="{{ temp_file_location }}" hidden></input>
                </div>
            </div>

            {% comment %}
            <div class="post-create__img post-create__form"> <!-- 기본 이미지 업로드 부분-->
                <div class="text-container">
                    <span>사진</span>
                </div>
                <div class="group-post__form-box">
                    <input class="group-post__form-input group-post__form-input--image" placeholder="첨부파일">
                    <label for="image" class="group-post__form-label">사진 올리기</label>
                    <input type="file" id="image" class="form__input--file" name="image" value="{% if post.image %}{{ post.image.url }}{% endif %}">
                </div>
            </div>
            
            <div class="post-create__attached-file post-create__form">
                <div class="text-container">
                    <span>파일</span>
                </div>
                <div class="group-post__form-box">
                    <input class="group-post__form-input group-post__form-input--file"  placeholder="첨부파일" >
                    <label for="attached_file" class="group-post__form-label">파일 올리기</label>
                    <input type="file" class="form__input--file" id="attached_file" name="attached_file" value="{{ form.attached_file.url }}">
                </div>
            </div>
            {% endcomment %}
            <div class="select__category post-create__category">
                <div class="text-container category-text">
                    <span>카테고리 고르기</span>
                </div>
                {% if error_messages.s_or_e_tag %}
                <span class="input-error">
                    <svg width="5" height="14" viewBox="0 0 9 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8.3125 21.5825C8.3125 23.7364 6.56016 25.4888 4.40625 25.4888C2.25234 25.4888 0.5 23.7364 0.5 21.5825C0.5 19.4286 2.25234 17.6763 4.40625 17.6763C6.56016 17.6763 8.3125 19.4286 8.3125 21.5825ZM0.952148 1.71919L1.61621 15.0004C1.64741 15.6241 2.16216 16.1138 2.78662 16.1138H6.02588C6.65034 16.1138 7.16509 15.6241 7.19629 15.0004L7.86035 1.71919C7.8938 1.0498 7.36016 0.48877 6.68994 0.48877H2.12256C1.45234 0.48877 0.918701 1.0498 0.952148 1.71919Z" fill="#EB6464"></path>
                    </svg>
                    {{ error_messages.s_or_e_tag }}
                </span>
                {% endif %}
                <div class="post-create__category-select">
                    <input type="radio" name="s_or_e_tag" value="S" id="scratch" class="tag" 
                    {% if original_information.s_or_e_tag == 'S' or question.s_or_e_tag == 'S' %} checked {% endif %}/>
                    <label for="scratch">스크래치</label>
                    <input type="radio" name="s_or_e_tag" value="E" id="entry" class="tag" 
                    {% if original_information.s_or_e_tag == 'E' or question.s_or_e_tag == 'E'%} checked {% endif %}/>
                    <label for="entry">엔트리</label>
                    <input type="radio" name="s_or_e_tag" value="ETC" id="etc" class="tag" 
                    {% if original_information.s_or_e_tag == 'ETC' or question.s_or_e_tag == 'ETC' %} checked {% endif %}/>
                    <label for="etc">기타</label>
                </div>
            </div>
            <div class="select__tag post-create__category">
                <div class="text-container category-text">
                    <span>상세 태그 고르기</span>
                </div>
                <div class="post-create__category-select post-create__tag-select">
                    <input type="checkbox" name="detail_tag" value="동작" id="motion" class="tag" {% if '동작' in basic_tag_names %} checked {% endif %} />
                    <label for="motion">동작</label>
                    <input type="checkbox" name="detail_tag" value="형태" id="looks" class="tag"  {% if '형태' in basic_tag_names %} checked {% endif %} />
                    <label for="looks">형태</label>
                    <input type="checkbox" name="detail_tag" value="소리" id="sound" class="tag" {% if '소리' in basic_tag_names %} checked  {% endif %}/>
                    <label for="sound">소리</label>
                    <input type="checkbox" name="detail_tag" value="이벤트" id="events" class="tag"{% if '이벤트' in basic_tag_names %} checked {% endif %} />
                    <label for="events">이벤트</label>
                    <input type="checkbox" name="detail_tag" value="제어" id="control" class="tag" {% if '제어' in basic_tag_names %} checked  {% endif %}/>
                    <label for="control">제어</label>
                    <input type="checkbox" name="detail_tag" value="감지" id="sensing" class="tag" {% if '감지' in basic_tag_names %} checked  {% endif %}/>
                    <label for="sensing">감지</label>
                    <input type="checkbox" name="detail_tag" value="연산" id="operators" class="tag "{% if '연산' in basic_tag_names %} checked  {% endif %}/>
                    <label for="operators">연산</label>
                    <input type="checkbox" name="detail_tag" value="변수" id="variables" class="tag" {% if '변수' in basic_tag_names %} checked  {% endif %}/>
                    <label for="variables">변수</label>
                    <input type="checkbox" name="detail_tag" value="내 블록" id="my" class="tag" {% if '내 블록' in basic_tag_names %} checked {% endif %}/>
                    <label for="my">내 블록</label>
                    <input type="checkbox" name="detail_tag" value="기타" id="detail_etc" class="tag" {% if '기타' in basic_tag_names %} checked {% endif %}/>
                    <label for="detail_etc">기타</label>
                    
                    {% for extra_tag in extra_tag_names %}
                    <input type="checkbox" name="detail_tag" value="{{ extra_tag }}" id="{{ extra_tag }}" class="tag" checked/>
                    <label for="{{ extra_tag }}">{{ extra_tag }}</label>
                    {% endfor %}
                    
                    <input type="checkbox" name="add_tag" value="ADD_TAG" id="add_tag" class="tag" />
                    <label for="add_tag">태그 추가</label>
                </div>
                <div class="add_tag__error-msg"></div>
            </div>
            <div class="tag_input_box"></div>
            <div class="post-create__btn">
                <button class="btn-save btn-effect" type="submit">올리기</button>
                <a href="{% url 'qna:question_list' %}" class="btn-return btn-effect">취소</a>
            </div>
        </form>
    </div>
</div>
    
    {% endblock %}