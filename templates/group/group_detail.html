{% extends 'base.html' %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'css/base.css' %}" />
    <link rel="stylesheet" href="{% static 'css/group_detail.css' %}" />
    <link rel="stylesheet" href="{% static 'css/group_detail_modal.css' %}" />
{% endblock %}

{% block js %}
    <script src="{% static 'js/group_detail.js' %}" defer></script>
{% endblock %}

{% block title %} ë„ì™€ì¤˜, ì½”ë”© | {{ group.name }} {% endblock %}

{% block content %}
{{ request.user.id|json_script:"user_id" }}
{{ group.id|json_script:"group_id" }}


<div class="group-detail__container--top">  <!-- í˜ì´ì§€ ìƒë‹¨ ì‹œì‘ -->
    <div class="container-top__title">
        <!-- ê·¸ë£¹ ì´ë¦„ -->
        <p class="container-top__title--name">{{ group.name }}</p>
        <!-- ê·¸ë£¹ ëª¨ë“œ (ê³µê°œ / ë¹„ê³µê°œ) -->
        <p class="container-top__title--i">
            {% if group.mode == 'PUBLIC' %}
                <i class="ri-lock-unlock-fill"></i>
                {% else %}
                <i class="ri-lock-2-fill"></i>
            {% endif %}
        </p>
    </div>
</div>  <!-- í˜ì´ì§€ ìƒë‹¨ ë -->

<div class="group-detail__container--button">   <!-- í˜ì´ì§€ ìƒë‹¨ ë²„íŠ¼ ì‹œì‘ -->
    <!-- ê³µê°œê·¸ë£¹ì¼ ê²½ìš°, ê·¸ë£¹ ì¢‹ì•„ìš” -->
    {% if group.mode == 'PUBLIC' %}
    <div class="all-group__heart button-left__like" id="all-group__heart">
        {% if is_liked %}
        <i class="fas fa-heart"></i>
        {% else %}
        <i class="far fa-heart"></i>
        {% endif %}
        <span>ì¢‹ì•„ìš” {{ total_likes }}ê°œ</span>
    </div>
    {% endif %}

    <!-- ë¹„ê³µê°œ ê·¸ë£¹ì¼ ê²½ìš°, ê·¸ë£¹ ì¢‹ì•„ìš” ìˆ¨ê¸°ê¸° -->
    <div class="all-group__heart button-left__like--private" id="all-group__heart"></div>

    <div class="container-button__right">
        <!-- ë‚´ ê·¸ë£¹ì¼ ê²½ìš°, ê·¸ë£¹ ì°œí•˜ê¸° -->
        {% if group in mygroup %}
        <div class="container-button__btn star__group">
            <span class="star group__keyword-star group__keyword-star--{{ group.id }}" id="keyword-star-{{ group.id }}">
                {% if is_star %} <!-- ê½‰ ì°¬ ë³„ -->
                <svg xmlns="http://www.w3.org/2000/svg" width="33" height="33" viewBox="0 0 33 33" fill="none">
                <path d="M14.2841 1.9274L14.284 1.92759L10.7818 9.44224L2.95814 10.6493C1.06844 10.9394 0.387624 13.3429 1.69516 14.6904C1.69521 14.6905 1.69526 14.6905 1.6953 14.6906L7.37193 20.5445L6.02817 28.821L6.02812 28.8213C5.72253 30.7113 7.63006 32.2674 9.33438 31.3119C9.33462 31.3118 9.33486 31.3117 9.33509 31.3115L16.3261 27.4227L23.3185 31.3124C23.3186 31.3124 23.3186 31.3124 23.3186 31.3124C25.0196 32.2589 26.9302 30.7151 26.624 28.8213L26.6239 28.821L25.2802 20.5446L30.9568 14.6906C32.2645 13.3431 31.5837 10.9394 29.694 10.6493L21.8703 9.44224L18.3681 1.92759L18.3677 1.92669C17.5428 0.165947 15.1196 0.136632 14.2841 1.9274Z" fill="#FFD76F" stroke="#828282"/>
                </svg>
                <span>ê·¸ë£¹ ì°œí•˜ê¸°</span>
                {% else %} <!-- ë¹ˆ ë³„ -->
                <svg xmlns="http://www.w3.org/2000/svg" width="33" height="33" viewBox="0 0 33 33" fill="none">
                <path d="M14.515 1.92759L14.5151 1.9274C15.3505 0.136631 17.7738 0.165947 18.5986 1.92669L18.5991 1.92759L22.1012 9.44224L29.9249 10.6493L29.9253 10.6494L29.8491 11.1435C31.2995 11.3662 31.8808 13.2585 30.829 14.3424L14.515 1.92759ZM14.515 1.92759L11.0128 9.44224L3.1891 10.6493C3.18901 10.6493 3.18893 10.6494 3.18884 10.6494C3.1888 10.6494 3.18875 10.6494 3.18871 10.6494C1.29931 10.9397 0.618669 13.343 1.92612 14.6904C1.92617 14.6905 1.92621 14.6905 1.92626 14.6906L7.60289 20.5446L6.25913 28.821L6.25907 28.8213C5.95349 30.7113 7.86102 32.2674 9.56534 31.3119C9.56557 31.3118 9.56581 31.3117 9.56605 31.3115L16.557 27.4227L23.5495 31.3124C25.2505 32.259 27.1611 30.7151 26.855 28.8213L26.8549 28.821L25.5111 20.5445L31.1878 14.6906L14.515 1.92759Z" stroke="white"/>
                </svg>
                <span>ê·¸ë£¹ ì°œí•˜ê¸°</span>
                {% endif %}
            </span>
        </div>
        {% endif %}

        <!-- ê·¸ë£¹ ì»¤ë®¤ë‹ˆí‹° -->
        <a href="{% url 'group:post_list' group.pk %}" class="container-button__btn btn-community">
            <span>ê·¸ë£¹ ì»¤ë®¤ë‹ˆí‹°</span>
        </a>
    </div>
</div>  <!-- í˜ì´ì§€ ìƒë‹¨ ë²„íŠ¼ ë -->

<div class="group-detail__container--info"> <!-- ê·¸ë£¹ ì •ë³´ ì‹œì‘ -->
    <div class="container-info__image">
        {% if group.image %}
        <img src="{{ group.image.url }}" />
        {% else %}
        <img src="{{ ani_image }}" />
        {% endif %}
    </div>

    <div class="conatiner-info__content">
        <div class="info-content__maker">
            <p class="text-box__top">ê·¸ë£¹ì„ ë§Œë“  ì‚¬ëŒ</p>
            <p class="text-box__bottom"><a href="{% url 'user:public_userpage' group.maker.pk %}" style="text-decoration: none; color:#4e4e4e;">{{ group.maker }}</a></p>
        </div>

        <div class="info-content__member">
            <p class="text-box__top">ê·¸ë£¹ ì¸ì›</p>
            <p class="text-box__bottom">{{ members|length }}ëª…</p>
        </div>

        <div class="info-content__intro">
            <p class="text-box__top">ê·¸ë£¹ ì†Œê°œ</p>
            <p class="text-box__bottom--intro">{{ group.intro }}</p>
        </div>
    </div>
</div>  <!-- ê·¸ë£¹ ì •ë³´ ë -->

<div class="group-detail__container--member">   <!-- ê·¸ë£¹ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ ì‹œì‘ -->
    <!-- ë¦¬ìŠ¤íŠ¸ ìƒë‹¨ -->
    <div class="container-member__top">
        <div class="member-top__left">
            ê·¸ë£¹ ë©¤ë²„
        </div>

        <!-- ê³µê°œ ê·¸ë£¹ì¸ ê²½ìš° -->
        {% if group.mode == 'PUBLIC' and maker == user %}
            <div class="member-top__right--public">
                <div class="top-right__button">
                    <span class="group__wait--btn">ëŒ€ê¸°ì ëª…ë‹¨ ë³´ê¸°</span>
                </div>

                <!-- ê·¸ë£¹ ëŒ€ê¸°ì ë¦¬ìŠ¤íŠ¸ modal -->
                <div class="group__member--all modal modal__hidden">
                    <div class="modal__overlay"></div>  <!-- ëª¨ë‹¬ ë°°ê²½ -->
                    <div class="modal__content">    <!-- ëª¨ë‹¬ ë‚´ìš© -->
                        <div class="modal__content--top">
                            <span>ê·¸ë£¹ ê°€ì… ëŒ€ê¸°ì</span>
                        </div>
                        <div class="modal__content--bottom group-wait__modal--bottom">
                            <div class="group__wait--member-list">  <!-- ëŒ€ê¸°ì ëª…ë‹¨ jsë¡œ ì¶”ê°€ -->
                            </div>
                        
                            <div class="group__wait--closebox">
                                <button class="group__wait--close modal__close" onclick="closeGroupWait()">ì™„ë£Œ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

        <!-- ë¹„ê³µê°œ ê·¸ë£¹ì¸ ê²½ìš°, ì´ˆëŒ€ ì½”ë“œë¡œ ê°€ì…í•˜ë¯€ë¡œ ëŒ€ê¸°ì ëª…ë‹¨ ë³´ê¸° í•„ìš” ì—†ìŒ! -->
        <!-- {% if maker == user %}
            <div class="member-top__right--private">
                <div class="top-right__button">
                    <span><button class="group__wait--btn" onclick="">ëŒ€ê¸°ì ëª…ë‹¨ ë³´ê¸°</button></span>
                </div>
            {% endif %} -->

        <!-- ë¹„ê³µê°œ ê·¸ë£¹ì¼ ê²½ìš°, ì´ˆëŒ€ ì½”ë“œ -->
        {% if group.mode == 'PRIVATE' %}
            <!-- ê·¸ë£¹ ì´ˆëŒ€ ë²„íŠ¼ -->
            <div class="group__code--btn top-right__button">
                <span>ë©¤ë²„ ì´ˆëŒ€ì½”ë“œ</span>
            </div>
            <!-- ê·¸ë£¹ ì´ˆëŒ€ì½”ë“œ ìƒì„± modal -->
            <div class="group__code--alert-box modal modal__hidden" id="create-code">
                <div class="modal__overlay"></div>
                <div class="modal__content">    <!-- ëª¨ë‹¬ ë‚´ìš© -->
                    <div class="modal__content--top">
                        <span>ë©¤ë²„ ì´ˆëŒ€ ì½”ë“œ</span>
                    </div>
                    <div class="modal__content--bottom">
                        <div class="code_box">
                        </div>
                        <button class="group__code--close modal__close" onclick="closeCreateCode()">í™•ì¸</button>
                    </div>
                </div>
            </div>
        {% endif %}
        </div>
    </div>

    <!-- ê·¸ë£¹ ë©¤ë²„ ëª…ë‹¨ -->
    <div class="container-member__list">
        <!-- ê·¸ë£¹ maker ë¨¼ì € -->
        <div class="member-list__maker">
            <span class="maker-icon">ğŸ‘‘</span>
            <div class="member-list__maker--left">   
                <div class="member-list__img">
                    {% if maker.img %}
                    <img src="{{ maker.img.url }}" height="50" width="50" style="border-radius: 50px;"/>
                    {% else %}
                    <img src="/static/img/user_thumbnail/{{ maker.default_img }}" height="50" width="50" style="border-radius: 50px;"/>
                    {% endif %}
                </div>

                <div class="member-list__maker--text member-list__maker--name">
                    <span class="text__name"><a href="{% url 'user:public_userpage' maker.pk %}">{{ maker }}</a></span>
                </div>
            </div>

            <!-- ìœ ì € ì†Œê°œ -->
            <div class="member-list__maker--text member-list__one--intro">
                {% if maker.introduction %}
                    <span class="text__intro">{{ maker.introduction }}</span>
                    {% else %}
                    <span class="text__intro">ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤. ë©¤ë²„ì—ê²Œ ì†Œê°œë¥¼ ë¶€íƒí•´ë³´ì„¸ìš”!</span>
                {% endif %}
            </div>
        </div>

        <!-- ê·¸ë£¹ ë©¤ë²„ -->
        {% for member in members %}     <!-- ë©¤ë²„ê°€ ìˆìœ¼ë©´ -->
        {% if member != maker %}
        <div class="member-list__member">
            <div class="member-list__member--left">
                <div class="member-list__img">  <!-- ë©¤ë²„ ì´ë¯¸ì§€ -->
                    {% if member.img %}
                    <img src="{{ member.img.url }}" />
                    {% else %}
                    <img src="/static/img/user_thumbnail/{{ member.default_img }}" />
                    {% endif %}
                </div>

                <div class="member-list__one--text member-list__maker--name">    <!-- ë©¤ë²„ ì´ë¦„ -->
                    <span class="text__name"><a href="{% url 'user:public_userpage' member.pk %}">{{ member }}</a></span>
                </div>
            </div>

            <div class="member-list__one--text member-list__one--intro">
                <!-- ë©¤ë²„ ì†Œê°œ -->
                {% if member.introduction %}
                <span class="text__intro">{{ member.introduction }}</span>
                <!-- <span class="text__intro">ë‘ ì¤„ì´ ë„˜ì–´ê°€ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ë³´ì—¬ì¤„ê²Œìš”! ë‘ ì¤„ì´ ë„˜ì–´ê°€ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ë³´ì—¬ì¤„ê²Œìš”!</span> -->
                {% else %}
                <span class="text__intro">ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤. ë©¤ë²„ì—ê²Œ ì†Œê°œë¥¼ ë¶€íƒí•´ë³´ì„¸ìš”!</span>
                {% endif %}
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>  <!-- ê·¸ë£¹ ë©¤ë²„ ë¦¬ìŠ¤íŠ¸ ë -->

<div class="group-detail__container--bottom">   <!-- í˜ì´ì§€ í•˜ë‹¨ ì‹œì‘ -->
    <!-- ìœ ì €ê°€ makerì¸ ê²½ìš° -->
    {% if maker == user %}
    <div class="bottom-btn__box">
        <a href="{% url 'group:group_update' group.pk %}" class="btn__update">ê·¸ë£¹ ì •ë³´ ìˆ˜ì •</a>
        <span class="btn__delete">ê·¸ë£¹ ì‚­ì œ</span>
        <span class="btn-out">ê·¸ë£¹ íƒˆí‡´í•˜ê¸°</span> 

        <!-- ê·¸ë£¹ ì‚­ì œ modal -->
        <!-- <div class="group__delete--alert">
            <div class="group__delete--text">ì •ë§ ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            <button class="group__delete--yes">ë„¤</button>
            <button class="group__delete--no" onclick="closeGroupDeleteAlert()">ì•„ë‹ˆìš”</button>
        </div>

        <!-- ê·¸ë£¹ íƒˆí‡´ modal -->
        <!-- <div class="group__drop--alert">
            <div class="group__drop--text">ì •ë§ ì„ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            <button class="group__drop--yes">ë„¤</button>
            <button class="group__drop--no" onclick="closeGroupOutAlert()">ì•„ë‹ˆìš”</button>
        </div> -->
    </div>
    {% endif %}

    <!-- ìœ ì €ê°€ memberì¸ ê²½ìš° -->
    {% if maker != user and user in members %}
        <div class="bottom-btn__box">
            <span class="btn-out">ê·¸ë£¹ íƒˆí‡´í•˜ê¸°</span> 
        </div>
    {% endif %}

    <!-- ê³µê°œ ê·¸ë£¹ + ìœ ì €ê°€ memberê°€ ì•„ë‹Œ ê²½ìš° -->
    {% if group.mode == 'PUBLIC' and user in waits %}
        <div class="bottom-btn__box">
            <span class="btn-join-out">ê°€ì… ëŒ€ê¸°ì¤‘ ğŸ’¬</span>
        </div>
    {% elif group.mode == 'PUBLIC' and user not in members %}
        <div class="bottom-btn__box">
            <span class="btn-signup">ê·¸ë£¹ ê°€ì…í•˜ê¸°</span>
        </div>
    {% endif %}
</div>  <!-- í˜ì´ì§€ í•˜ë‹¨ ë-->




<!-- ì˜ˆì¤€ì´ ë¶€ë¶„ -->
{% comment %}
<div class="group-info align-center">
    <div class="group-info__nav d-flex flex-row">
        <nav>
            <a href="{% url 'group:group_home' %}">ê·¸ë£¹ í™ˆ</a>
            {% if group.mode == 'PRIVATE' %}
                {% if maker == user %}
                <!-- ê·¸ë£¹ ì´ˆëŒ€ì½”ë“œ ìƒì„± modal -->
                <div class="group__code--alert-box" id="create-code">
                    ì¹œêµ¬ ì´ˆëŒ€
                    <div class="code_box">
                    </div>
                    <button class="group__code--close btn btn-dark" onclick="closeCreateCode()">ë‹«ê¸°</button>
                </div>
                <button class="group__code--btn btn btn-dark">ì¹œêµ¬ ì´ˆëŒ€í•˜ê¸°</button>

                {% endif %}
        <a href="{% url 'group:post_list' group.pk %}">ê·¸ë£¹ ì»¤ë®¤ë‹ˆí‹°</a>
            {% endif %}



                <!-- ê°€ì… ëŒ€ê¸° ë¦¬ìŠ¤íŠ¸ modal -->


        </nav>
    </div>

    {% if group.mode == 'PUBLIC' %}
        <div class="all-group__heart btn btn-primary" id="all-group__heart">
            {% if is_liked %}
            <i class="fas fa-heart"></i>
            {% else %}
            <i class="far fa-heart"></i>
            {% endif %}
            <span>ì¢‹ì•„ìš” {{ total_likes }}ê°œ</span>
        </div>
    {% endif %}

    <div class="group-info__member">
        <h3>ë©¤ë²„ ëª…ë‹¨</h3>
        <div class="d-flex flex-row align-items-center">
            {% if maker.img %}
            <img src="{{ maker.img.url }}" height="50" width="50" style="border-radius: 50px;"/>
            {% else %}
            <img src="{{ profile_img }}" height="50" width="50" style="border-radius: 50px;"/>
            {% endif %}
        </div>
        {% for member in members %}
            {% if member != maker %}
                <div class="d-flex flex-row align-items-center">
                    {% if member.img %}
                    <img src="{{ member.img.url }}" height="50" width="50" style="border-radius: 50px;"/>
                    {% else %}
                    <img src="{{ profile_img }}" height="50" width="50" style="border-radius: 50px;"/>
                    {% endif %}
                    <h6><a href="{% url 'group:group_member_state' %}">{{ member }}</a></h6>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <div class="group-info__input">
        <a href="{% url 'group:group_home' %}" class="list_btn btn btn-light">ëª©ë¡</a>

        <!-- ìœ ì €ê°€ ë©¤ë²„ì¼ ê²½ìš° -->
        {% if member == user %}
        <a href="{% url 'group:group_drop' group.pk %}" class="btn btn-light">ê·¸ë£¹ íƒˆí‡´</a>
        {% endif %}

        <!-- ìœ ì €ê°€ ë©”ì´ì»¤ì¸ ê²½ìš° -->
        {% if maker == user %}
        <a href="{% url 'group:group_delete' group.pk %}" class="delete_btn btn btn-light">ê·¸ë£¹ ì‚­ì œ</a>
        <a href="{% url 'group:group_update' group.pk %}" class="update_btn btn btn-light">ìˆ˜ì •</a>
        {% endif %}

        <!-- ê³µê°œ ê·¸ë£¹ì¸ ê²½ìš° + ìœ ì €ê°€ ë©¤ë²„ê°€ ì•„ë‹Œ ê²½ìš° -->
        {% if group.mode == 'PUBLIC' %}
            {% if maker != user %}
                {% if member != user %}
                <a href="{% url 'group:public_group_join' group.pk %}" class="btn btn-light">ê·¸ë£¹ ê°€ì…</a>
                {% endif %}
            {% endif %}
        {% endif %}

    </div>
</div>
{% endcomment %}

{% endblock %}